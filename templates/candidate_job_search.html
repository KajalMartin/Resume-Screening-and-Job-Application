<!-- templates/candidate_job_search.html -->
{% extends 'candidate_dashboard_base.html' %}

{% block title %}Job Search{% endblock %}

{% block content %}
    <!-- Header -->
    <div class="dashboard-header">
        <h1>Job Search</h1>
        <div class="header-actions">
            <div class="date-display">
                <i class="fas fa-search"></i>
                <span>{{ jobs|length }} jobs found</span>
            </div>
        </div>
    </div>

    <!-- Search Filters -->
    <div class="dashboard-card" style="margin-bottom: 20px;">
        <div class="card-body">
            <form method="GET" action="{{ url_for('candidate.job_search') }}" id="searchForm">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-size: 14px;">Job Title/Company</label>
                        <input type="text" name="search" placeholder="Search jobs..." value="{{ request.args.get('search', '') }}" 
                               class="form-control" style="background: var(--card-bg);">
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-size: 14px;">Location</label>
                        <input type="text" name="location" placeholder="City, State, or Remote" value="{{ request.args.get('location', '') }}"
                               class="form-control" style="background: var(--card-bg);">
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-size: 14px;">Experience</label>
                        <select name="experience" class="form-control" style="background: var(--card-bg);">
                            <option value="all">All Experience Levels</option>
                            <option value="entry" {% if request.args.get('experience') == 'entry' %}selected{% endif %}>Entry Level</option>
                            <option value="mid" {% if request.args.get('experience') == 'mid' %}selected{% endif %}>Mid Level</option>
                            <option value="senior" {% if request.args.get('experience') == 'senior' %}selected{% endif %}>Senior Level</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-size: 14px;">Job Type</label>
                        <select name="job_type" class="form-control" style="background: var(--card-bg);">
                            <option value="all">All Types</option>
                            <option value="fulltime" {% if request.args.get('job_type') == 'fulltime' %}selected{% endif %}>Full-time</option>
                            <option value="parttime" {% if request.args.get('job_type') == 'parttime' %}selected{% endif %}>Part-time</option>
                            <option value="contract" {% if request.args.get('job_type') == 'contract' %}selected{% endif %}>Contract</option>
                            <option value="remote" {% if request.args.get('job_type') == 'remote' %}selected{% endif %}>Remote</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: space-between;">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-search"></i> Search Jobs
                    </button>
                    <button type="button" onclick="clearSearch()" class="btn btn-outline">
                        <i class="fas fa-times"></i> Clear Filters
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Jobs List -->
    <div class="dashboard-card">
        <div class="card-body">
            {% if jobs %}
                <div class="candidates-list">
                    {% for job in jobs %}
                    <div class="candidate-item">
                        <div class="candidate-avatar" style="background: var(--primary-gradient);">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <div class="candidate-info">
                            <h4>{{ job.title }}</h4>
                            <p>{{ job.company }} â€¢ {{ job.location or 'Location not specified' }}</p>
                            <div class="candidate-tags">
                                <span class="tag">{{ job.job_type|title }}</span>
                                {% if job.salary_range %}
                                <span class="tag">{{ job.salary_range }}</span>
                                {% endif %}
                                <span class="tag">{{ job.created_at.strftime('%b %d, %Y') }}</span>
                            </div>
                            <div style="margin-top: 10px;">
                                <p style="color: var(--text-secondary); font-size: 14px;">
                                    {{ job.description[:150] }}...
                                </p>
                            </div>
                        </div>
                        <div class="candidate-actions">
                            {% if job.id in applied_job_ids %}
                                <button class="btn btn-success btn-sm" disabled style="cursor: not-allowed;">
                                    <i class="fas fa-check"></i> Applied
                                </button>
                            {% else %}
                                <a href="{{ url_for('candidate.apply_job', job_id=job.id) }}" class="btn btn-primary btn-sm">
                                    <i class="fas fa-paper-plane"></i> Apply Now
                                </a>
                            {% endif %}
                            <button class="btn btn-outline btn-sm" onclick="viewJobDetails({{ job.id }})" style="margin-top: 5px;">
                                <i class="fas fa-eye"></i> View Details
                            </button>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="text-align: center; padding: 3rem;">
                    <i class="fas fa-search" style="font-size: 48px; color: var(--text-secondary); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--text-primary); margin-bottom: 10px;">No jobs found</h3>
                    <p style="color: var(--text-secondary);">Try adjusting your search filters or check back later for new opportunities.</p>
                    <button onclick="clearSearch()" class="btn btn-primary" style="margin-top: 20px;">
                        <i class="fas fa-times"></i> Clear Search
                    </button>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    function clearSearch() {
        window.location.href = '{{ url_for("candidate.job_search") }}';
    }
    
    function viewJobDetails(jobId) {
        // In a real app, you would fetch and display job details
        alert('Job details feature coming soon!');
    }
</script>
{% endblock %}