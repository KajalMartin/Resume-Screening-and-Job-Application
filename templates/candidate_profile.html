<!-- templates/candidate_profile.html -->
{% extends 'candidate_dashboard_base.html' %}

{% block title %}My Profile{% endblock %}

{% block content %}
    <!-- Header -->
    <div class="dashboard-header">
        <h1>My Profile</h1>
        <div class="header-actions">
            <div class="date-display">
                <i class="fas fa-user"></i>
                <span>Profile Settings</span>
            </div>
        </div>
    </div>

    <!-- Profile Card -->
    <div class="dashboard-card" style="margin-bottom: 20px;">
        <div class="card-body">
            <div class="profile-header">
                <div class="profile-avatar-large">
                    {{ candidate.name[:2].upper() if candidate and candidate.name else 'JS' }}
                </div>
                <div class="profile-info-large">
                    <h3>{{ candidate.name if candidate else user_name }}</h3>
                    <div class="job-title">{{ candidate.experience or 'Job Seeker' }}</div>
                    <div class="match-score" style="margin-top: 10px;">
                        <span class="score-badge">
                            <i class="fas fa-star"></i> Complete your profile for better matches
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Form -->
    <div class="dashboard-card">
        <div class="card-body">
            <form method="POST" action="{{ url_for('candidate.update_profile') }}" enctype="multipart/form-data">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <!-- Left Column -->
                    <div>
                        <h3 style="margin-bottom: 20px; color: var(--text-primary);">Personal Information</h3>
                        
                        <div class="form-group">
                            <label for="name">Full Name *</label>
                            <input type="text" id="name" name="name" 
                                   value="{{ candidate.name if candidate else user_name }}" 
                                   required class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="email">Email Address *</label>
                            <input type="email" id="email" name="email" 
                                   value="{{ candidate.email if candidate else '' }}" 
                                   required class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" name="phone" 
                                   value="{{ candidate.phone if candidate else '' }}" 
                                   class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="experience">Experience Level</label>
                            <input type="text" id="experience" name="experience" 
                                   value="{{ candidate.experience if candidate else '' }}" 
                                   placeholder="e.g., 3-5 years, Senior, Entry Level" 
                                   class="form-control">
                        </div>
                    </div>
                    
                    <!-- Right Column -->
                    <div>
                        <h3 style="margin-bottom: 20px; color: var(--text-primary);">Professional Details</h3>
                        
                        <div class="form-group">
                            <label for="education">Education</label>
                            <input type="text" id="education" name="education" 
                                   value="{{ candidate.education if candidate else '' }}" 
                                   placeholder="e.g., Bachelor's in Computer Science" 
                                   class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="skills">Skills *</label>
                            <textarea id="skills" name="skills" rows="3" 
                                      placeholder="Enter your skills separated by commas (e.g., Python, JavaScript, React, AWS)" 
                                      required class="form-control">{{ candidate.skills if candidate else '' }}</textarea>
                            <small style="color: var(--text-secondary);">These skills are used for job matching</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="resume">Resume (PDF/DOCX)</label>
                            <input type="file" id="resume" name="resume" 
                                   accept=".pdf,.doc,.docx" 
                                   class="form-control" style="padding: 10px;">
                            {% if candidate and candidate.resume_url %}
                            <small style="color: var(--text-secondary); margin-top: 5px; display: block;">
                                <i class="fas fa-file-pdf"></i> Resume uploaded: {{ candidate.resume_url.split('/')[-1] }}
                            </small>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                    <div style="display: flex; justify-content: flex-end; gap: 10px;">
                        <button type="button" onclick="window.location.reload()" class="btn btn-outline">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Profile
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Profile Statistics -->
    <div class="dashboard-card">
        <div class="card-header">
            <h3>Profile Statistics</h3>
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                <div style="text-align: center;">
                    <div style="font-size: 32px; font-weight: bold; color: var(--primary-color);">
                        {% if candidate and candidate.skills %}{{ candidate.skills.split(',')|length }}{% else %}0{% endif %}
                    </div>
                    <div style="color: var(--text-secondary);">Skills Listed</div>
                </div>
                
                <div style="text-align: center;">
                    <div style="font-size: 32px; font-weight: bold; color: var(--secondary-color);">
                        {% if candidate and candidate.resume_url %}✓{% else %}✗{% endif %}
                    </div>
                    <div style="color: var(--text-secondary);">Resume Uploaded</div>
                </div>
                
                <div style="text-align: center;">
                    <div style="font-size: 32px; font-weight: bold; color: var(--warning-color);">
                        75%
                    </div>
                    <div style="color: var(--text-secondary);">Profile Completion</div>
                </div>
                
                <div style="text-align: center;">
                    <div style="font-size: 32px; font-weight: bold; color: var(--accent-color2);">
                        {{ total_applications if total_applications is defined else '0' }}
                    </div>
                    <div style="color: var(--text-secondary);">Total Applications</div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}