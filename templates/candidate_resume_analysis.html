<!-- templates/candidate_resume_analysis.html -->
{% extends 'candidate_dashboard_base.html' %}

{% block title %}Resume Analysis{% endblock %}

{% block extra_css %}
<style>
    .analysis-card {
        background: var(--card-bg2);
        border: 1px solid var(--border-color);
        border-radius: 16px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
    
    .skill-meter {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1rem;
    }
    
    .skill-label {
        width: 150px;
        font-size: 0.875rem;
        color: var(--text-secondary);
    }
    
    .meter-bar {
        flex: 1;
        height: 8px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        overflow: hidden;
    }
    
    .meter-fill {
        height: 100%;
        background: var(--primary-gradient);
        border-radius: 4px;
    }
    
    .meter-value {
        width: 40px;
        text-align: right;
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--primary-color);
    }
    
    .keyword-tag {
        display: inline-block;
        background: rgba(59, 130, 246, 0.2);
        color: var(--primary-color);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        margin: 0.25rem;
        font-size: 0.875rem;
    }
    
    .keyword-tag.count-3 { background: rgba(16, 185, 129, 0.2); color: var(--secondary-color); }
    .keyword-tag.count-5 { background: rgba(245, 158, 11, 0.2); color: var(--warning-color); }
    .keyword-tag.count-8 { background: rgba(139, 92, 246, 0.2); color: var(--accent-color2); }
</style>
{% endblock %}

{% block content %}
    <!-- Header -->
    <div class="dashboard-header">
        <h1>Resume Analysis</h1>
        <div class="header-actions">
            <div class="date-display">
                <i class="fas fa-chart-line"></i>
                <span>AI-Powered Analysis</span>
            </div>
        </div>
    </div>

    <!-- Overall Score -->
    <div class="dashboard-card" style="margin-bottom: 20px;">
        <div class="card-body">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <h3 style="margin-bottom: 10px;">Resume Strength</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">
                        AI analysis of your resume's effectiveness and areas for improvement
                    </p>
                </div>
                <div style="position: relative; width: 120px; height: 120px;">
                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; 
                                 border-radius: 50%; background: conic-gradient(var(--primary-color) 0% {{ analysis.profile_strength }}%, 
                                 rgba(59, 130, 246, 0.2) {{ analysis.profile_strength }}% 100%);"></div>
                    <div style="position: absolute; top: 10px; left: 10px; right: 10px; bottom: 10px; 
                                 background: var(--card-bg2); border-radius: 50%;"></div>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                                 font-size: 32px; font-weight: bold; background: var(--primary-gradient); 
                                 -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        {{ analysis.profile_strength }}%
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Two Column Layout -->
    <div class="dashboard-grid">
        <!-- Keyword Analysis -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>Keyword Analysis</h3>
            </div>
            <div class="card-body">
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; color: var(--text-primary);">Skills Mentioned</h4>
                    <div>
                        {% for keyword, count in analysis.keyword_analysis.items() %}
                        <span class="keyword-tag count-{{ count if count <= 8 else 8 }}">
                            {{ keyword.replace('_', ' ')|title }} ({{ count }}x)
                        </span>
                        {% endfor %}
                    </div>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 15px; color: var(--text-primary);">Strength Metrics</h4>
                    <div class="skill-meter">
                        <div class="skill-label">Technical Skills</div>
                        <div class="meter-bar">
                            <div class="meter-fill" style="width: 85%;"></div>
                        </div>
                        <div class="meter-value">85%</div>
                    </div>
                    <div class="skill-meter">
                        <div class="skill-label">Achievements</div>
                        <div class="meter-bar">
                            <div class="meter-fill" style="width: 70%;"></div>
                        </div>
                        <div class="meter-value">70%</div>
                    </div>
                    <div class="skill-meter">
                        <div class="skill-label">Action Verbs</div>
                        <div class="meter-bar">
                            <div class="meter-fill" style="width: 60%;"></div>
                        </div>
                        <div class="meter-value">60%</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Suggested Improvements -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>Suggested Improvements</h3>
            </div>
            <div class="card-body">
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; color: var(--text-primary);">Skills Gap</h4>
                    <div>
                        {% for skill in analysis.skills_gap %}
                        <div style="display: flex; align-items: center; justify-content: space-between; 
                                     padding: 12px; background: rgba(255, 255, 255, 0.02); 
                                     border-radius: 8px; margin-bottom: 8px;">
                            <span>{{ skill }}</span>
                            <a href="#" style="color: var(--primary-color); font-size: 12px;">
                                <i class="fas fa-external-link-alt"></i> Learn
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 15px; color: var(--text-primary);">Recommendations</h4>
                    <div>
                        {% for improvement in analysis.suggested_improvements %}
                        <div style="display: flex; align-items: flex-start; margin-bottom: 12px;">
                            <i class="fas fa-check-circle" style="color: var(--secondary-color); 
                                 margin-right: 10px; margin-top: 3px;"></i>
                            <span>{{ improvement }}</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ATS Optimization -->
        <div class="dashboard-card candidate">
            <div class="card-header">
                <h3>ATS Optimization</h3>
            </div>
            <div class="card-body">
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; color: var(--text-primary);">ATS Compatibility Score</h4>
                    <div style="text-align: center;">
                        <div style="font-size: 48px; font-weight: bold; color: var(--secondary-color); margin-bottom: 10px;">
                            88/100
                        </div>
                        <p style="color: var(--text-secondary);">
                            Your resume is well-optimized for Applicant Tracking Systems
                        </p>
                    </div>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 15px; color: var(--text-primary);">Optimization Tips</h4>
                    <div>
                        <div style="display: flex; align-items: flex-start; margin-bottom: 12px;">
                            <i class="fas fa-check" style="color: var(--secondary-color); 
                                 margin-right: 10px; margin-top: 3px;"></i>
                            <span>Standard fonts (Arial, Calibri, Times New Roman) ✓</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; margin-bottom: 12px;">
                            <i class="fas fa-check" style="color: var(--secondary-color); 
                                 margin-right: 10px; margin-top: 3px;"></i>
                            <span>Clean formatting without tables ✓</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; margin-bottom: 12px;">
                            <i class="fas fa-exclamation-triangle" style="color: var(--warning-color); 
                                 margin-right: 10px; margin-top: 3px;"></i>
                            <span>Consider adding more quantifiable achievements</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Action Buttons -->
    <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button class="btn btn-primary" onclick="downloadReport()">
            <i class="fas fa-download"></i> Download Analysis Report
        </button>
        <button class="btn btn-outline" onclick="window.location.href='{{ url_for('candidate.profile') }}'">
            <i class="fas fa-edit"></i> Update Resume
        </button>
        <button class="btn btn-outline" onclick="viewSampleResumes()">
            <i class="fas fa-eye"></i> View Sample Resumes
        </button>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    function downloadReport() {
        alert('Analysis report download feature coming soon!');
    }
    
    function viewSampleResumes() {
        alert('Sample resumes feature coming soon!');
    }
    
    // Animate progress bars on load
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => {
            document.querySelectorAll('.meter-fill').forEach(fill => {
                const width = fill.style.width;
                fill.style.width = '0';
                setTimeout(() => {
                    fill.style.width = width;
                }, 100);
            });
        }, 500);
    });
</script>
{% endblock %}